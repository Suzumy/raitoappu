ctfで大事なのは
-> フラグの場所

脆弱性をすべて試す->すべて試すのは難しいしその必要はない

flagの場所
-> フロント？ 
-> DB?
-> その他?

フラグの場所を考えてから、逆算して脆弱性を考えることが可能になる。

flag
-> クローラ(ページを見る機能,robot.txt)、DB、サーバのファイルなど
すべてに使える銀の脆弱性はない！

クローラにある場合
-> adminにURLを教えるようなページやボタンの実装がある
XSSなどのクローラを対象としたもの

DBにある場合
-> データベースを操作していそうな実装。エラーが不正な入力で起こる

SQLiなどのDBを対象とした脆弱性を求める

サーバのファイルにある
->ソースコードや使用しているソフトウェア情報を見る。ソフトウェア固有機能や古いバージョンが動作している

SSTI,XXEなどファイルを対象とした脆弱性を考える

クローラのcookieに脆弱性がある -> どうすればとれる？jacascriptの実行 -> CSPの制限 <- scriptタグを挿入できる


CTFの誘導
1.ジャンル、問題名、問題文から得られる情報
->背景-問題の背景
->技術,キーワード - 問題を解くために必要な脆弱性の名前
->FLAGのある場所、解き方 - そのまま

2.配布ファイルの表層から得られる情報
->file:ファイルの内容からファイル形式を出力
->readelf:ELFファイルの情報を出力
->strings:ファイル内の表示可能な文字を出力
->binwalk:ファイルないに埋め込まれたファイルの情報を出力
->exittool:メタ情報の読み取りと書き込みを行う
->cehcksec:ファイルのセキュリティ機構の状態を出力

rev - file, stringgs, binwalk
リバースエンジニアリングツールによ見込ませる ghidra, ida

pwn - file, checksecなど


3.配布ファイルの解析から得られる情報
->これらがあると何からすればいいかわかる。

静的解析 - ファイルを実行しないで行う解析
・コードを読む
・逆アセンブリ

コメントなどの情報を得られるが、振る舞いは確認できない

動的解析 - ファイルを実行して行う解析
・実際の挙動を確認する
・ライブラリをリンクして実行

手元で実験ができるが、手元で環境を作る必要がある


pwn
setvbufなどは基本関係ないことが書かれていることが多い。
呼ばれている関数+CTF, pwnとかで調べてみる。
セキュリティ機構を調べる。
RELRO - read onlyの部分を決める情報

Stack Canary -　スタックBOFに対する防御機構

NX - メモリ領域のデータを実行不可にする

PIE - バイナリ中のアドレスを相対アドレスに置き換える

libc - one gadget rce 条件を満たしてここに飛ばせば攻撃に使える。

execve("/bin")

one_gadget