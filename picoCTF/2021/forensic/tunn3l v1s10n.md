# tunn3l v1s10n

## 大会：picoCTF2021
### 分野：Forensics
* * *
問題としてtunn3l_v1s10nというファイルが渡される。
fileコマンド、foremostなどでは情報が出なかったため、バイナリエディタでファイルを開いてみる。

先頭がBMで始まっているため、bmpファイルの可能性が高い。
しかし、fileコマンドで何も出なかったということはデータが破損している可能性が高いため、bmpファイルのフォーマットと比較しながら情報を修正していく。

先頭から2byte -> ファイルタイプ BM
ここは大丈夫そう

次の4byte -> ファイルサイズ 86 26 2c 00 これがビックエンディアンになっているため、反対から読み 00 2c 26 8eとなる。これを10進数に直すと2893454byte ファイルサイズと合致するためここもOK

次の2byte -> 予約領域1 00 00
ここもOK

次の2byte -> 予約領域2 00 00
ここもOK

次の4byte -> ファイル先頭からのオフセット
ちょっとよくわからないのでパス

次の4byte -> 情報ヘッダサイズ 40
ここがBA D0 00 00(0xD0BA)になっている　ここは本来40(0x28)のため、28 00 00 00に修正する。

このタイミングで画像を見てみると、横長な画像になっており、ファイルサイズも元の大きさよりもだいぶ小さくなっている。
ここから画像が本来の大きさではないと考えられるため、画像の縦の長さを調整していく

縦の大きさは2行目の+6から始まるため、ここを40 03 00 00(0x340)に調整する。
ここで画像を開くとフラグが出てくるため、これをsubmitする。