# ret2libc9-2
## 始めて学ぶバイナリ解析
## pwn
***

s8ではリターンアドレスを書き換えることで、本来実行されないはずだった関数を無理やり呼び出すという攻撃を行ったが、s9ではソースコードに書かれていない関数を呼び出すlibc攻撃を行う。  
BOFを起こす手順はs8と同じだが、system関数をしようするため、引数を壊さないようにスタックを上書きする必要がある。  

s8とおなじてじゅんで以下のことが分かった。  
* offsetが44
* system関数のアドレスがf7e1a250

これに追加して、今回は/bin/shのアドレスを調べる必要があるが、今回はプログラムがリークしてる(教えてくれる)ので、それを使う。これにより、以下のようにスタックを書き換えればいいことが分かった。  
適当な文字列44文字+system関数のアドレス(0xf7e1a250)+リターンアドレス(適当な4バイトで可)+bin/shのアドレス(リーク)  

ここまで来たらこれをexploitコードを書く。
```
from pwn import *
p = process("./a.out")
p.sendline("A"*44+"\x50xa2\xe1\xf7BBBB\x08\x70\x55\x56")
p.interactive()
```

これを実行するとシェルを起動することができる。シェルを起動すればサーバーで様々な操作ができるため、攻撃が成功したといえる。